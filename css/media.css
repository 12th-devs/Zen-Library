/* MEDIA SECTION */
.media-filter-bar {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    padding: 4px;
    margin: 4px 16px 8px 16px;
    flex-shrink: 0;
    background: var(--zen-toolbar-element-bg);
    border-radius: 8px;
}

.media-filter-pill {
    flex: 1;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s var(--zen-library-easing);
    opacity: 0.8;
    border: none;
}

.media-filter-pill:hover {
    opacity: 0.9;
    background: var(--tab-hover-background-color);
}

.media-filter-pill.active {
    opacity: 1;
    background: var(--tab-hover-background-color);
    font-weight: 600;
}

.icon-mask {
    width: 16px;
    height: 16px;
    background-color: currentColor;
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    opacity: 1;
}


.icon-all {
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8.4 3H4.6C4.03995 3 3.75992 3 3.54601 3.10899C3.35785 3.20487 3.20487 3.35785 3.10899 3.54601C3 3.75992 3 4.03995 3 4.6V8.4C3 8.96005 3 9.24008 3.10899 9.45399C3.20487 9.64215 3.35785 9.79513 3.54601 9.89101C3.75992 10 4.03995 10 4.6 10H8.4C8.96005 10 9.24008 10 9.45399 9.89101C9.64215 9.79513 9.79513 9.64215 9.89101 9.45399C10 9.24008 10 8.96005 10 8.4V4.6C10 4.03995 10 3.75992 9.89101 3.54601C9.79513 3.35785 9.64215 3.20487 9.45399 3.10899C9.24008 3 8.96005 3 8.4 3Z'/%3E%3Cpath d='M19.4 3H15.6C15.0399 3 14.7599 3 14.546 3.10899C14.3578 3.20487 14.2049 3.35785 14.109 3.54601C14 3.75992 14 4.03995 14 4.6V8.4C14 8.96005 14 9.24008 14.109 9.45399C14.2049 9.64215 14.3578 9.79513 14.546 9.89101C14.7599 10 15.0399 10 15.6 10H19.4C19.9601 10 20.2401 10 20.454 9.89101C20.6422 9.79513 20.7951 9.64215 20.891 9.45399C21 9.24008 21 8.96005 21 8.4V4.6C21 4.03995 21 3.75992 20.891 3.54601C20.7951 3.35785 20.6422 3.20487 20.454 3.10899C20.2401 3 19.9601 3 19.4 3Z'/%3E%3Cpath d='M19.4 14H15.6C15.0399 14 14.7599 14 14.546 14.109C14.3578 14.2049 14.2049 14.3578 14.109 14.546C14 14.7599 14 15.0399 14 15.6V19.4C14 19.9601 14 20.2401 14.109 20.454C14.2049 20.6422 14.3578 20.7951 14.546 20.891C14.7599 21 15.0399 21 15.6 21H19.4C19.9601 21 20.2401 21 20.454 20.891C20.6422 20.7951 20.7951 20.6422 20.891 20.454C21 20.2401 21 19.9601 21 19.4V15.6C21 15.0399 21 14.7599 20.891 14.546C20.7951 14.3578 20.6422 14.2049 20.454 14.109C20.2401 14 19.9601 14 19.4 14Z'/%3E%3Cpath d='M8.4 14H4.6C4.03995 14 3.75992 14 3.54601 14.109C3.35785 14.2049 3.20487 14.3578 3.10899 14.546C3 14.7599 3 15.0399 3 15.6V19.4C3 19.9601 3 20.2401 3.10899 20.454C3.20487 20.6422 3.35785 20.7951 3.54601 20.891C3.75992 21 4.03995 21 4.6 21H8.4C8.96005 21 9.24008 21 9.45399 20.891C9.64215 20.7951 9.79513 20.6422 9.89101 20.454C10 20.2401 10 19.9601 10 19.4V15.6C10 15.0399 10 14.7599 9.89101 14.546C9.79513 14.3578 9.64215 14.2049 9.45399 14.109C9.24008 14 8.96005 14 8.4 14Z'/%3E%3C/svg%3E");
}

.icon-images {
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4.27209 20.7279L10.8686 14.1314C11.2646 13.7354 11.4627 13.5373 11.691 13.4632C11.8918 13.3979 12.1082 13.3979 12.309 13.4632C12.5373 13.5373 12.7354 13.7354 13.1314 14.1314L19.6839 20.6839M14 15L16.8686 12.1314C17.2646 11.7354 17.4627 11.5373 17.691 11.4632C17.8918 11.3979 18.1082 11.3979 18.309 11.4632C18.5373 11.5373 18.7354 11.7354 19.1314 12.1314L22 15M10 9C10 10.1046 9.10457 11 8 11C6.89543 11 6 10.1046 6 9C6 7.89543 6.89543 7 8 7C9.10457 7 10 7.89543 10 9ZM6.8 21H17.2C18.8802 21 19.7202 21 20.362 20.673C20.9265 20.3854 21.3854 19.9265 21.673 19.362C22 18.7202 22 17.8802 22 16.2V7.8C22 6.11984 22 5.27976 21.673 4.63803C21.3854 4.07354 20.9265 3.6146 20.362 3.32698C19.7202 3 18.8802 3 17.2 3H6.8C5.11984 3 4.27976 3 3.63803 3.32698C3.07354 3.6146 2.6146 4.07354 2.32698 4.63803C2 5.27976 2 6.11984 2 7.8V16.2C2 17.8802 2 18.7202 2.32698 19.362C2.6146 19.9265 3.07354 20.3854 3.63803 20.673C4.27976 21 5.11984 21 6.8 21Z'/%3E%3C/svg%3E");
}

.icon-videos {
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7 2V6M7 16V20M17 4V8M17 18V22M2 6H12M2 16H12M12 8H22M12 18H22M12 20V3.6C12 3.03995 12 2.75992 11.891 2.54601C11.7951 2.35785 11.6422 2.20487 11.454 2.10899C11.2401 2 10.9601 2 10.4 2H6.8C5.11984 2 4.27976 2 3.63803 2.32698C3.07354 2.6146 2.6146 3.07354 2.32698 3.63803C2 4.27976 2 5.11984 2 6.8V15.2C2 16.8802 2 17.7202 2.32698 18.362C2.6146 18.9265 3.07354 19.3854 3.63803 19.673C4.27976 20 5.11984 20 6.8 20H12ZM12 4H17.2C18.8802 4 19.7202 4 20.362 4.32698C20.9265 4.6146 21.3854 5.07354 21.673 5.63803C22 6.27976 22 7.11984 22 8.8V17.2C22 18.8802 22 19.7202 21.673 20.362C21.3854 20.9265 20.9265 21.3854 20.362 21.673C19.7202 22 18.8802 22 17.2 22H13.6C13.0399 22 12.7599 22 12.546 21.891C12.3578 21.7951 12.2049 21.6422 12.109 21.454C12 21.2401 12 20.9601 12 20.4V4Z'/%3E%3C/svg%3E");
}

.icon-audio {
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 10L3 14M7.5 11V13M12 6V18M16.5 3V21M21 10V14'/%3E%3C/svg%3E");
}

.icon-play {
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none'%3E%3Cpath d='M5 4.98951C5 4.01835 5 3.53277 5.20249 3.2651C5.37889 3.03191 5.64852 2.88761 5.9404 2.87018C6.27544 2.85017 6.67946 3.11953 7.48752 3.65823L18.0031 10.6686C18.6708 11.1137 19.0046 11.3363 19.1209 11.6168C19.2227 11.8621 19.2227 12.1377 19.1209 12.383C19.0046 12.6635 18.6708 12.886 18.0031 13.3312L7.48752 20.3415C6.67946 20.8802 6.27544 21.1496 5.9404 21.1296C5.64852 21.1122 5.37889 20.9679 5.20249 20.7347C5 20.467 5 19.9814 5 19.0103V4.98951Z' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
}

.icon-pause {
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none'%3E%3Cpath d='M9.5 15V9M14.5 15V9M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
}

.audio-preview-icon {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--zen-library-hover-bg);
    position: relative;
    border-radius: var(--border-radius-medium);
}

.media-card .placeholder-icon {
    width: 82px;
    height: 82px;
    opacity: 0.4;
    transition: opacity 0.2s ease, transform 0.2s ease;
}

.media-card:hover .placeholder-icon {
    opacity: 0 !important;
    transform: scale(0.9);
}

.progress-bar-container {
    position: absolute;
    bottom: 12px;
    left: 12px;
    right: 12px;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0;
    border-radius: 3px;
    overflow: hidden;
    transition: opacity 0.2s ease;
}

.media-card.playing .progress-bar-container {
    opacity: 1;
}

.progress-bar-fill {
    height: 100%;
    width: 0%;
    background: var(--zen-primary-color, #3b82f6);
    transition: width 0s linear;
    border-radius: 3px;
}

.audio-control-overlay {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s ease;
    transform: translateY(-16px);
}

.media-card:hover .audio-control-overlay {
    opacity: 1;
}

.media-card.playing:not(:hover) .audio-control-overlay {
    opacity: 0;
}

.audio-control-overlay .icon-mask {
    width: 80px;
    height: 80px;
    background-color: currentColor;
    opacity: 0.4;
}

.media-card .icon-pause {
    display: none;
}

.media-card.playing .icon-play {
    display: none;
}

.media-card.playing .icon-pause {
    display: block;
}

.media-card.dragging {
    opacity: 0.5 !important;
    transform: scale(0.98);
    cursor: grabbing;
    transition: transform 0.1s ease-out, opacity 0.1s ease-out;
}

.media-card {
    cursor: grab;
}

.media-card:active {
    cursor: grabbing;
}

.media-grid {
    position: absolute;
    inset: 0;
    display: block;
    padding: 0 16px;
    box-sizing: border-box;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: auto;
    scrollbar-color: color-mix(in srgb, currentColor, transparent 50%) transparent;
}

.media-grid::-webkit-scrollbar {
    width: 4px;
}

.media-grid::-webkit-scrollbar-thumb {
    background: color-mix(in srgb, currentColor, transparent 50%);
    border-radius: 10px;
}

.media-grid::-webkit-scrollbar-track {
    background: transparent !important;
}

.media-masonry-wrapper {
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    gap: 16px;
    width: 100%;
}

.media-masonry-column {
    display: flex;
    flex-direction: column;
    gap: 16px;
    flex: 1;
    min-width: 0;
}

.media-card {
    background: var(--zen-library-hover-bg, var(--ws-tab-hover-color, rgba(255, 255, 255, 0.08)));
    border: none;
    border-radius: var(--border-radius-medium);
    overflow: hidden;
    break-inside: avoid;
    display: flex;
    flex-direction: column;
    position: relative;
    cursor: pointer;
    transition: background-color 0.2s ease, box-shadow 0.2s ease;
    margin-bottom: 0;
    transform: translateZ(0);
}

.media-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: transparent;
    transition: background 0.2s ease;
    z-index: 1;
    pointer-events: none;
    border-radius: inherit;
}

.media-card:hover::after {
    background: rgba(0, 0, 0, 0.4);
}

.media-card:active {
    opacity: 1;
}

.media-preview-container {
    width: 100%;
    margin: 0;
    background: var(--zen-library-hover-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    min-height: 120px;
    border-radius: var(--border-radius-medium);
}

.audio-preview-container {
    aspect-ratio: 1 / 1;
    width: 100%;
    margin: 0;
    background: var(--zen-library-hover-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    border-radius: var(--border-radius-medium);
}

.cover-art {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    z-index: 0;
}

.gif-badge {
    position: absolute;
    top: 8px;
    left: 8px;
    padding: 2px 6px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    font-size: 10px;
    font-weight: 600;
    border-radius: 5px;
    z-index: 2;
    transition: opacity 0.2s;
    text-transform: uppercase;
}

.media-card img,
.media-card video {
    width: 100%;
    height: auto;
    min-height: 100%;
    object-fit: cover;
    display: block;
    transition: opacity 0.3s;
    z-index: 0;
}

.media-info {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 10px 12px;
    display: flex;
    flex-direction: column;
    gap: 1px;
    background: light-dark(color-mix(in srgb, var(--zen-primary-color, #3b82f6), white 70%),
            color-mix(in srgb, var(--zen-primary-color, #3b82f6), black 40%));
    color: inherit !important;
    opacity: 0;
    transform: translateY(10px);
    transition: transform 0.2s var(--zen-library-easing), opacity 0.2s var(--zen-library-easing);
    pointer-events: none;
    z-index: 2;
}

.media-card:hover .media-info {
    opacity: 1;
    transform: translateY(0);
}

.media-meta-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}

.media-title {
    font-size: 11px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.media-meta,
.media-time {
    font-size: 10px;
    opacity: 0.8;
}

.video-duration-badge {
    position: absolute;
    top: 8px;
    left: 8px;
    padding: 2px 6px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    font-size: 10px;
    font-weight: 600;
    border-radius: 5px;
    z-index: 2;
    transition: opacity 0.2s;
}

.media-glance-info {
    padding: 16px 20px;
    background: rgba(20, 20, 20, 0.8);
    color: #fff;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.media-glance-title {
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-right: 20px;
}

.empty-icon.media-icon {
    background: transparent !important;
    background-image: none !important;
    mask-image: none !important;
    width: 64px !important;
    height: 64px !important;
    opacity: 0.2;
}

.empty-icon.media-icon svg {
    display: block;
    margin: 0 auto;
    width: 64px !important;
    height: 64px !important;
}

/* === 13. CONTEXT MENU (MATCHING SPACES/ZEN DESIGN) === */

.media-context-menu {
    position: fixed;
    z-index: 10;
    background: light-dark(color-mix(in srgb, var(--zen-primary-color, #3b82f6), white 70%),
            color-mix(in srgb, var(--zen-primary-color, #3b82f6), black 40%));
    border-radius: 12px;
    padding: 6px;
    min-width: 160px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    animation: menuSpringIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.15);
    transform-origin: top left;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.media-context-menu .media-menu-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 12.5px;
    font-weight: 550;
    color: var(--zen-sidebar-text-color);
    transition: background 0.08s ease;
    user-select: none;
}

.media-context-menu .media-menu-item:hover {
    background: var(--zen-library-hover-bg);
}

.media-context-menu .media-menu-item:active {
    background: var(--zen-library-active-bg);
}

.media-context-menu .menu-icon {
    width: 16px;
    height: 16px;
    color: inherit;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.9;
}

.media-context-menu .menu-icon svg {
    width: 100%;
    height: 100%;
}

@keyframes menuSpringIn {
    from {
        opacity: 0;
        transform: translateY(-10px) scale(0.94);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}